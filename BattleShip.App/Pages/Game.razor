@page "/battleship"
@inject HttpClient Http
@inject GameState GameState

<h3>Bataille Navale</h3>

<!-- Bouton pour démarrer une nouvelle partie -->
<button @onclick="StartNewGame">Démarrer une nouvelle partie</button>

<!-- Grille du joueur -->
@if (GameState.PlayerGrid != null)
{
    <h4>Grille du Joueur</h4>
    <table>
        @for (int i = 0; i < GameState.PlayerGrid.GetLength(0); i++)
        {
            <tr>
                @for (int j = 0; j < GameState.PlayerGrid.GetLength(1); j++)
                {
                    <td style="padding: 5px; border: 1px solid black; text-align: center;">
                        @if (GameState.PlayerGrid[i, j] == '\0')
                        {
                            <span>.</span> <!-- Case vide -->
                        }
                        else if (GameState.PlayerGrid[i, j] == 'X')
                        {
                            <img src="hit.png" alt="touché" /> <!-- Bateau touché -->
                        }
                        else if (GameState.PlayerGrid[i, j] == 'O')
                        {
                            <img src="miss.png" alt="raté" /> <!-- Raté -->
                        }
                        else
                        {
                            <span>@GameState.PlayerGrid[i, j]</span> <!-- Lettre du bateau -->
                        }
                    </td>
                }
            </tr>
        }
    </table>
}

<!-- Grille de l'adversaire -->
@if (GameState.OpponentGrid != null)
{
    <h4>Grille de l'Adversaire (Secrète)</h4>
    <table>
        @for (int i = 0; i < GameState.OpponentGrid.GetLength(0); i++)
        {
            <tr>
                @for (int j = 0; j < GameState.OpponentGrid.GetLength(1); j++)
                {
                    <td @onclick="(() => MakeAttack(i, j))" style="padding: 5px; border: 1px solid black; text-align: center; cursor: pointer;">
                        @if (GameState.OpponentGrid[i, j] == null)
                        {
                            <span>.</span> <!-- Case non jouée -->
                        }
                        else if (GameState.OpponentGrid[i, j] == true)
                        {
                            <img src="hit.png" alt="touché" /> <!-- Touché -->
                        }
                        else
                        {
                            <img src="miss.png" alt="raté" /> <!-- Raté -->
                        }
                    </td>
                }
            </tr>
        }
    </table>
}